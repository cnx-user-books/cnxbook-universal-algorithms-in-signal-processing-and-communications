<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:bib="http://bibtexml.sf.net/">
  <title>Source models</title>
<metadata xmlns:md="http://cnx.rice.edu/mdml">
  <md:content-id>m46231</md:content-id>
  <md:title>Source models</md:title>
  <md:abstract/>
  <md:uuid>d1230af8-089b-495e-a0ef-3d7401da75a6</md:uuid>
</metadata>

<content>
    <para id="id62155">For i.i.d. sources, <m:math overflow="scroll"><m:mrow><m:mrow><m:mi>D</m:mi><m:mo>(</m:mo></m:mrow><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mi>n</m:mi></m:msup><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>|</m:mo><m:mo>|</m:mo></m:mrow><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mi>n</m:mi></m:msup><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>n</m:mi><m:mi>D</m:mi><m:mo>(</m:mo></m:mrow><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>|</m:mo><m:mo>|</m:mo></m:mrow><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math>,
which means that the divergence increases linearly with <m:math overflow="scroll"><m:mi>n</m:mi></m:math>.
Not only does the divergence increase, but it does so by a constant per symbol.
Therefore, based on typical sequence concepts that we have seen, for an <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mi>n</m:mi></m:msup></m:math> generated by <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub></m:math>,
its probability under <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub></m:math> vanishes. However, we can construct a distribution <m:math overflow="scroll"><m:mi>Q</m:mi></m:math> whose divergence
with both <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub></m:math> abd <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub></m:math> is small,</para>
    <equation id="id62882">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:mi>Q</m:mi>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>=</m:mo>
          <m:mfrac>
            <m:mn>1</m:mn>
            <m:mn>2</m:mn>
          </m:mfrac>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mn>1</m:mn>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>+</m:mo>
          <m:mfrac>
            <m:mn>1</m:mn>
            <m:mn>2</m:mn>
          </m:mfrac>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mn>2</m:mn>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>.</m:mo>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id62965">We now have for <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub></m:math>,</para>
    <equation id="uid1">
      <m:math overflow="scroll" mode="display">
        <m:mtable displaystyle="true">
          <m:mtr>
            <m:mtd columnalign="right">
              <m:mrow>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mi>n</m:mi>
                </m:mfrac>
                <m:mrow>
                  <m:mi>D</m:mi>
                  <m:mo>(</m:mo>
                </m:mrow>
                <m:msubsup>
                  <m:mi>P</m:mi>
                  <m:mn>1</m:mn>
                  <m:mi>n</m:mi>
                </m:msubsup>
                <m:mrow>
                  <m:mo>|</m:mo>
                  <m:mo>|</m:mo>
                  <m:mi>Q</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:mtd>
            <m:mtd>
              <m:mo>=</m:mo>
            </m:mtd>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mi>n</m:mi>
                </m:mfrac>
                <m:mi>E</m:mi>
                <m:mfenced separators="" open="[" close="]">
                  <m:mo form="prefix">log</m:mo>
                  <m:mfrac>
                    <m:mrow>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>x</m:mi>
                          <m:mi>n</m:mi>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mrow>
                    <m:mrow>
                      <m:mfrac>
                        <m:mn>1</m:mn>
                        <m:mn>2</m:mn>
                      </m:mfrac>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>x</m:mi>
                          <m:mi>n</m:mi>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>+</m:mo>
                      <m:mfrac>
                        <m:mn>1</m:mn>
                        <m:mn>2</m:mn>
                      </m:mfrac>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>x</m:mi>
                          <m:mi>n</m:mi>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mrow>
                  </m:mfrac>
                </m:mfenced>
              </m:mrow>
            </m:mtd>
          </m:mtr>
          <m:mtr>
            <m:mtd/>
            <m:mtd>
              <m:mo>≤</m:mo>
            </m:mtd>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mi>n</m:mi>
                </m:mfrac>
                <m:mo form="prefix">log</m:mo>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mn>2</m:mn>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>=</m:mo>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mi>n</m:mi>
                </m:mfrac>
                <m:mo>.</m:mo>
              </m:mrow>
            </m:mtd>
          </m:mtr>
        </m:mtable>
      </m:math>
    </equation>
    <para id="id63184">On the other hand, <m:math overflow="scroll"><m:mrow><m:mfrac><m:mn>1</m:mn><m:mi>n</m:mi></m:mfrac><m:mrow><m:mi>D</m:mi><m:mo>(</m:mo></m:mrow><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:msubsup><m:mi>x</m:mi><m:mn>1</m:mn><m:mi>n</m:mi></m:msubsup><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>|</m:mo><m:mo>|</m:mo><m:mi>Q</m:mi></m:mrow><m:mrow><m:mo>(</m:mo><m:msubsup><m:mi>x</m:mi><m:mn>1</m:mn><m:mi>n</m:mi></m:msubsup><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>)</m:mo><m:mo>≥</m:mo><m:mn>0</m:mn></m:mrow></m:mrow></m:math> <link target-id="uid11" document="m46240"/>,
and so</para><equation id="id63263">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:mfrac>
            <m:mn>1</m:mn>
            <m:mi>n</m:mi>
          </m:mfrac>
          <m:mo>≥</m:mo>
          <m:mfrac>
            <m:mn>1</m:mn>
            <m:mi>n</m:mi>
          </m:mfrac>
          <m:mrow>
            <m:mi>D</m:mi>
            <m:mo>(</m:mo>
          </m:mrow>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mn>1</m:mn>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:msubsup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mrow>
            <m:mo>|</m:mo>
            <m:mo>|</m:mo>
            <m:mi>Q</m:mi>
          </m:mrow>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:msubsup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mrow>
            <m:mo>)</m:mo>
            <m:mo>≥</m:mo>
            <m:mn>0</m:mn>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id63349">By symmetry, we see that <m:math overflow="scroll"><m:mi>Q</m:mi></m:math> is also close to <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub></m:math> in the divergence sense.</para>
    <para id="id63375">Intuitively, it might seem peculiar that <m:math overflow="scroll"><m:mi>Q</m:mi></m:math> is close to
both <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub></m:math> and <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub></m:math> but they are far away from each other (in divergence terms). This intuition
stems from the triangle inequality, which holds for all metrics. The contradiction is resolved by realizing
that the divergence is not a metric, and it does not satisfy the triangle inequality.</para>
    <para id="id63416">Note also that for two i.i.d. distributions <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub></m:math> and <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub></m:math>, the divergence</para>
    <equation id="id63446">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:mrow>
            <m:mi>D</m:mi>
            <m:mo>(</m:mo>
          </m:mrow>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mn>1</m:mn>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mrow>
            <m:mo>|</m:mo>
            <m:mo>|</m:mo>
          </m:mrow>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mn>2</m:mn>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mrow>
            <m:mo>)</m:mo>
            <m:mo>=</m:mo>
            <m:mi>n</m:mi>
            <m:mi>D</m:mi>
            <m:mo>(</m:mo>
          </m:mrow>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mn>1</m:mn>
          </m:msub>
          <m:mrow>
            <m:mo>|</m:mo>
            <m:mo>|</m:mo>
          </m:mrow>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mn>2</m:mn>
          </m:msub>
          <m:mrow>
            <m:mo>)</m:mo>
          </m:mrow>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id63541">is linear in <m:math overflow="scroll"><m:mi>n</m:mi></m:math>.
If <m:math overflow="scroll"><m:mi>Q</m:mi></m:math> were i.i.d., then <m:math overflow="scroll"><m:mrow><m:mi>D</m:mi><m:mo>(</m:mo><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mi>n</m:mi></m:msup><m:mo>)</m:mo></m:mrow><m:mo>∥</m:mo><m:mi>Q</m:mi><m:mrow><m:mo>(</m:mo><m:msubsup><m:mi>x</m:mi><m:mn>1</m:mn><m:mi>n</m:mi></m:msubsup><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:math> must also be linear in <m:math overflow="scroll"><m:mi>n</m:mi></m:math>. But the divergence is not increasing
linearly in <m:math overflow="scroll"><m:mi>n</m:mi></m:math>, it is upper bounded by 1. Therefore, we conclude that <m:math overflow="scroll"><m:mrow><m:mi>Q</m:mi><m:mo>(</m:mo><m:mo>·</m:mo><m:mo>)</m:mo></m:mrow></m:math> is not an i.i.d.
distribution. Instead, <m:math overflow="scroll"><m:mi>Q</m:mi></m:math> is a distribution that contains memory, and there is dependence in <m:math overflow="scroll"><m:mi>Q</m:mi></m:math>
between collections of different symbols of <m:math overflow="scroll"><m:mi>x</m:mi></m:math> in the sense that they are either all drawn from <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub></m:math>
or all drawn from <m:math overflow="scroll"><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub></m:math>.
To take this one step further, consider <m:math overflow="scroll"><m:mi>K</m:mi></m:math> sources with</para>
    <equation id="id63709">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:mi>Q</m:mi>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>=</m:mo>
          <m:munderover>
            <m:mo>∑</m:mo>
            <m:mrow>
              <m:mi>i</m:mi>
              <m:mo>=</m:mo>
              <m:mn>1</m:mn>
            </m:mrow>
            <m:mi>K</m:mi>
          </m:munderover>
          <m:mfrac>
            <m:mn>1</m:mn>
            <m:mi>K</m:mi>
          </m:mfrac>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mi>i</m:mi>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>,</m:mo>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id63779">then in an analogous manner to before it can be shown that</para>
    <equation id="id63785">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:mrow>
            <m:mi>D</m:mi>
            <m:mo>(</m:mo>
          </m:mrow>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mi>i</m:mi>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:msubsup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mrow>
            <m:mo>|</m:mo>
            <m:mo>|</m:mo>
            <m:mi>Q</m:mi>
          </m:mrow>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:msubsup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mrow>
            <m:mo>)</m:mo>
            <m:mo>≤</m:mo>
          </m:mrow>
          <m:mfrac>
            <m:mn>1</m:mn>
            <m:mi>n</m:mi>
          </m:mfrac>
          <m:mo form="prefix">log</m:mo>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:mi>K</m:mi>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>.</m:mo>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id63872"><emphasis effect="bold">Sources with memory</emphasis>: Instead of the memoryless (i.i.d.) source,</para>
    <equation id="id63880">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:mi>P</m:mi>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>=</m:mo>
          <m:munderover>
            <m:mo>∏</m:mo>
            <m:mrow>
              <m:mi>i</m:mi>
              <m:mo>=</m:mo>
              <m:mn>1</m:mn>
            </m:mrow>
            <m:mi>n</m:mi>
          </m:munderover>
          <m:mi>P</m:mi>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>,</m:mo>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id63938">let us now put forward a statistical model with memory,</para>
    <equation id="id63944">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:mi>P</m:mi>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mi>n</m:mi>
            </m:msup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>=</m:mo>
          <m:munderover>
            <m:mo>∏</m:mo>
            <m:mrow>
              <m:mi>i</m:mi>
              <m:mo>=</m:mo>
              <m:mn>1</m:mn>
            </m:mrow>
            <m:mi>n</m:mi>
          </m:munderover>
          <m:mi>P</m:mi>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:mo>|</m:mo>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mn>1</m:mn>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msubsup>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>.</m:mo>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id64021"><emphasis effect="bold">Stationary source</emphasis>: To understand the notion of a stationary source, consider an infinite stream of symbols,
<m:math overflow="scroll"><m:mrow><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo></m:mrow></m:math>.
A complete probabilistic description of a stationary distribution is given by the collection of all
marginal distribution of the following form for all <m:math overflow="scroll"><m:mi>t</m:mi></m:math> and <m:math overflow="scroll"><m:mi>n</m:mi></m:math>,</para>
    <equation id="id64096">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:msub>
            <m:mi>P</m:mi>
            <m:mrow>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>t</m:mi>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mo>+</m:mo>
                  <m:mi>n</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
            </m:mrow>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mi>t</m:mi>
            </m:msub>
            <m:mo>,</m:mo>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mrow>
                <m:mi>t</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>,</m:mo>
            <m:mo>.</m:mo>
            <m:mo>.</m:mo>
            <m:mo>.</m:mo>
            <m:mo>,</m:mo>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mrow>
                <m:mi>t</m:mi>
                <m:mo>+</m:mo>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msub>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>.</m:mo>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id64219">For a stationary source, this distribution is independent of <m:math overflow="scroll"><m:mi>t</m:mi></m:math>.</para>
    <para id="id64233"><emphasis effect="bold">Entropy rate</emphasis>: We have defined the first order entropy of an i.i.d. random variable <link target-id="uid10" document="m46240"/>,
and let us discuss more advanced concepts for sources with memory.
Such definitions appear in many standard textbooks, for example that by
Gallager <link target-id="bid0"/>.</para><list id="id64251" display="block" list-type="enumerated">
      <item id="uid2">The <emphasis effect="italics">order-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> entropy</emphasis> is defined,
<equation id="id64278"><m:math overflow="scroll" mode="display"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>n</m:mi></m:msub><m:mo>=</m:mo><m:mfrac><m:mn>1</m:mn><m:mi>n</m:mi></m:mfrac><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mo>-</m:mo><m:mfrac><m:mn>1</m:mn><m:mi>n</m:mi></m:mfrac><m:mi>E</m:mi><m:mrow><m:mo>[</m:mo><m:mo form="prefix">log</m:mo><m:mrow><m:mo>(</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>]</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:math></equation></item>
      <item id="uid3">The <emphasis effect="italics">entropy rate</emphasis> is the limit of order-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> entropy, <m:math overflow="scroll"><m:mrow><m:mover><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover><m:mo>=</m:mo><m:msub><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mrow><m:mi>n</m:mi><m:mo>→</m:mo><m:mi>∞</m:mi></m:mrow></m:msub><m:msub><m:mi>H</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math>.
The existence of this limit will be shown soon.
</item>
      <item id="uid4"><emphasis effect="italics">Conditional entropy</emphasis> is defined similarly to entropy as the expectation of the log of
the conditional probability,
<equation id="id64480"><m:math overflow="scroll" mode="display"><m:mrow><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mo>-</m:mo><m:mfrac><m:mn>1</m:mn><m:mi>n</m:mi></m:mfrac><m:mi>E</m:mi><m:mrow><m:mo>[</m:mo><m:mo form="prefix">log</m:mo><m:mrow><m:mo>(</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>]</m:mo></m:mrow><m:mo>,</m:mo></m:mrow></m:math></equation>
where expectation is taken over the joint probability space, <m:math overflow="scroll"><m:mrow><m:mi>P</m:mi><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:math>.
</item>
    </list>
    <para id="id64660">The entropy rate also satisfies <m:math overflow="scroll"><m:mrow><m:mover><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover><m:mo>=</m:mo><m:msub><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mrow><m:mi>n</m:mi><m:mo>→</m:mo><m:mi>∞</m:mi></m:mrow></m:msub><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.</para>
    <para id="id64738"><emphasis effect="bold">Theorem 3</emphasis> 
For a stationary source with bounded first order entropy, <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>&lt;</m:mo><m:mi>∞</m:mi></m:mrow></m:math>, the following hold.</para><list id="id64776" display="block" list-type="enumerated">
      <item id="uid6">The conditional entropy <m:math overflow="scroll"><m:mrow><m:mi>H</m:mi><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:math> is monotone non-increasing in n.
</item>
      <item id="uid7">The order-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> entropy is not smaller than the conditional entropy,
<equation id="id64864"><m:math overflow="scroll" mode="display"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>≥</m:mo><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mo>.</m:mo></m:mrow></m:math></equation></item>
      <item id="uid8">The order-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> entropy <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is monotone non-increasing.
</item>
      <item id="uid9"><m:math overflow="scroll"><m:mrow><m:mover><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mrow><m:mi>n</m:mi><m:mo>→</m:mo><m:mi>∞</m:mi></m:mrow></m:msub><m:msub><m:mi>H</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mrow><m:mi>n</m:mi><m:mo>→</m:mo><m:mi>∞</m:mi></m:mrow></m:msub><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.
</item>
    </list>
    <para id="id65121"><emphasis effect="italics">Proof.</emphasis> <emphasis effect="bold">Part (1):</emphasis>
    </para><equation id="uid10">
      <m:math overflow="scroll" mode="display">
        <m:mtable displaystyle="true">
          <m:mtr>
            <m:mtd columnalign="right">
              <m:mrow>
                <m:mi>H</m:mi>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mo>|</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mn>1</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mtd>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>≤</m:mo>
                <m:mi>H</m:mi>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mo>|</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mn>2</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mtd>
          </m:mtr>
          <m:mtr>
            <m:mtd/>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>=</m:mo>
                <m:mi>H</m:mi>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msub>
                <m:mo>|</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mn>1</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>-</m:mo>
                    <m:mn>2</m:mn>
                  </m:mrow>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mtd>
          </m:mtr>
          <m:mtr>
            <m:mtd/>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>≤</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>≤</m:mo>
                <m:mi>H</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mn>2</m:mn>
                  </m:msub>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>≤</m:mo>
                <m:mi>H</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>.</m:mo>
              </m:mrow>
            </m:mtd>
          </m:mtr>
        </m:mtable>
      </m:math>
    </equation>
    <para id="id65369">
      <emphasis effect="bold">Part (2):</emphasis>
    </para>
    <equation id="uid11">
      <m:math overflow="scroll" mode="display">
        <m:mtable displaystyle="true">
          <m:mtr>
            <m:mtd columnalign="right">
              <m:mrow>
                <m:msub>
                  <m:mi>H</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:mtd>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>=</m:mo>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mi>n</m:mi>
                </m:mfrac>
                <m:mrow>
                  <m:mo>[</m:mo>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>+</m:mo>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>+</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>+</m:mo>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mi>n</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>]</m:mo>
                </m:mrow>
              </m:mrow>
            </m:mtd>
          </m:mtr>
          <m:mtr>
            <m:mtd/>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>≥</m:mo>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mi>n</m:mi>
                </m:mfrac>
                <m:mrow>
                  <m:mo>[</m:mo>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mi>n</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>+</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>+</m:mo>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mi>n</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>]</m:mo>
                </m:mrow>
              </m:mrow>
            </m:mtd>
          </m:mtr>
          <m:mtr>
            <m:mtd/>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>=</m:mo>
                <m:mi>H</m:mi>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mo>|</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mn>1</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msub>
                <m:mo>)</m:mo>
                <m:mo>.</m:mo>
              </m:mrow>
            </m:mtd>
          </m:mtr>
        </m:mtable>
      </m:math>
    </equation>
    <para id="id65712"><emphasis effect="bold">Part (3):</emphasis> This comes from the fist equality in the proof of (2),
because we have the average of a monotonely non-increasing sequence.</para>
    <para id="id65721"><emphasis effect="bold">Part (4):</emphasis> Both sequences are monotone non-increasing (parts (1) and (3)) and bounded below (by zero). Therefore, they both have a limit. Denote <m:math overflow="scroll"><m:mrow><m:mover><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mrow><m:mi>n</m:mi><m:mo>→</m:mo><m:mi>∞</m:mi></m:mrow></m:msub><m:msub><m:mi>H</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>
and <m:math overflow="scroll"><m:mrow><m:mover accent="true"><m:mi>H</m:mi><m:mo>˜</m:mo></m:mover><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mo movablelimits="true" form="prefix">lim</m:mo><m:mrow><m:mi>n</m:mi><m:mo>→</m:mo><m:mi>∞</m:mi></m:mrow></m:msub><m:mi>H</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.</para>
    <para id="id65876">Owing to part(2), <m:math overflow="scroll"><m:mrow><m:mover accent="true"><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover><m:mo>≥</m:mo><m:mover accent="true"><m:mi>H</m:mi><m:mo>˜</m:mo></m:mover></m:mrow></m:math>. Therefore, it suffices to prove <m:math overflow="scroll"><m:mrow><m:mover accent="true"><m:mi>H</m:mi><m:mo>˜</m:mo></m:mover><m:mo>≥</m:mo><m:mover accent="true"><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover></m:mrow></m:math>.</para>
    <equation id="uid12">
      <m:math overflow="scroll" mode="display">
        <m:mtable displaystyle="true">
          <m:mtr>
            <m:mtd columnalign="right">
              <m:mrow>
                <m:msub>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>m</m:mi>
                  </m:mrow>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:mtd>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>=</m:mo>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>m</m:mi>
                  </m:mrow>
                </m:mfrac>
                <m:mfenced separators="" open="[" close="]">
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msubsup>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mi>n</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msubsup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>+</m:mo>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mi>n</m:mi>
                    </m:mrow>
                    <m:mrow>
                      <m:mi>n</m:mi>
                      <m:mo>+</m:mo>
                      <m:mi>m</m:mi>
                    </m:mrow>
                  </m:munderover>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mfenced>
              </m:mrow>
            </m:mtd>
          </m:mtr>
          <m:mtr>
            <m:mtd/>
            <m:mtd columnalign="left">
              <m:mrow>
                <m:mo>≤</m:mo>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>H</m:mi>
                    <m:mo>(</m:mo>
                    <m:msubsup>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mi>n</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msubsup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>m</m:mi>
                  </m:mrow>
                </m:mfrac>
                <m:mo>+</m:mo>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>m</m:mi>
                    <m:mo>+</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>n</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>m</m:mi>
                  </m:mrow>
                </m:mfrac>
                <m:mi>H</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>.</m:mo>
              </m:mrow>
            </m:mtd>
          </m:mtr>
        </m:mtable>
      </m:math>
    </equation>
    <para id="id66209">Now fix <m:math overflow="scroll"><m:mi>n</m:mi></m:math> and take the limit for large <m:math overflow="scroll"><m:mi>m</m:mi></m:math>. The inequality <m:math overflow="scroll"><m:mrow><m:mover accent="true"><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover><m:mo>≤</m:mo><m:mover accent="true"><m:mi>H</m:mi><m:mo>˜</m:mo></m:mover></m:mrow></m:math> appears,
which proves that both limits are equal.</para>
    <para id="id66261"><emphasis effect="bold">Coding theorem</emphasis>: <link target-id="id64738">Theorem 3</link> yields for fixed to variable length coding
that for a stationary source, there exists a lossless code such that the compression
rate <m:math overflow="scroll"><m:msub><m:mi>ρ</m:mi><m:mi>n</m:mi></m:msub></m:math> obeys,</para><equation id="id66290">
      <m:math overflow="scroll" mode="display">
        <m:mrow>
          <m:msub>
            <m:mi>ρ</m:mi>
            <m:mi>n</m:mi>
          </m:msub>
          <m:mo>=</m:mo>
          <m:mfrac>
            <m:mrow>
              <m:mi>E</m:mi>
              <m:mo>[</m:mo>
              <m:mi>l</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mn>1</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>.</m:mo>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>]</m:mo>
            </m:mrow>
            <m:mi>n</m:mi>
          </m:mfrac>
          <m:mo>≤</m:mo>
          <m:msub>
            <m:mi>H</m:mi>
            <m:mi>n</m:mi>
          </m:msub>
          <m:mrow>
            <m:mo>(</m:mo>
            <m:mi>x</m:mi>
            <m:mo>)</m:mo>
          </m:mrow>
          <m:mo>+</m:mo>
          <m:mfrac>
            <m:mn>1</m:mn>
            <m:mi>n</m:mi>
          </m:mfrac>
          <m:mo>.</m:mo>
        </m:mrow>
      </m:math>
    </equation>
    <para id="id66382">This can be proved, for example, by choosing <m:math overflow="scroll"><m:mrow><m:mi>l</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mrow><m:mo>⌈</m:mo><m:mo>-</m:mo><m:mo form="prefix">log</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>⌉</m:mo></m:mrow></m:mrow></m:math>,
which is a Shannon code.
As <m:math overflow="scroll"><m:mi>n</m:mi></m:math> is increased, the compression rate <m:math overflow="scroll"><m:msub><m:mi>ρ</m:mi><m:mi>n</m:mi></m:msub></m:math> converges to the entropy rate.</para>
    <para id="id66500">We also have a converse theorem for lossless coding of stationary sources. That is,
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>ρ</m:mi><m:mi>n</m:mi></m:msub><m:mo>≥</m:mo><m:msub><m:mi>H</m:mi><m:mi>n</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>≥</m:mo><m:mover accent="true"><m:mi>H</m:mi><m:mo>¯</m:mo></m:mover></m:mrow></m:math>.</para>
    <section id="uid13">
      <title>Stationary Ergodic Sources</title>
      <para id="id66556">Consider the sequence <m:math overflow="scroll"><m:mrow><m:mi>x</m:mi><m:mo>=</m:mo><m:mo>(</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>)</m:mo></m:mrow></m:math>. Let <m:math overflow="scroll"><m:mrow><m:msup><m:mi>x</m:mi><m:mo>'</m:mo></m:msup><m:mo>=</m:mo><m:msub><m:mi>S</m:mi><m:mi>x</m:mi></m:msub></m:mrow></m:math> denote a step <m:math overflow="scroll"><m:mrow><m:mo>∀</m:mo><m:mi>n</m:mi><m:mo>∈</m:mo><m:mi mathvariant="double-struck">Z</m:mi></m:mrow></m:math>, <m:math overflow="scroll"><m:mrow><m:msubsup><m:mi>x</m:mi><m:mi>n</m:mi><m:mo>'</m:mo></m:msubsup><m:mo>=</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:math>,
where <m:math overflow="scroll"><m:msubsup><m:mi>S</m:mi><m:mi>x</m:mi><m:mi>i</m:mi></m:msubsup></m:math> takes <m:math overflow="scroll"><m:mi>i</m:mi></m:math> steps. Let <m:math overflow="scroll"><m:mrow><m:msub><m:mi>f</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> be a function that operates on coordinates <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>0</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>)</m:mo></m:mrow></m:math>.
An ergodic source has the property that empirical averages converge to statistical averages,</para>
      <equation id="id66795">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:mfrac>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>0</m:mn>
              </m:mrow>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:munderover>
            <m:msub>
              <m:mi>f</m:mi>
              <m:mi>k</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msubsup>
                <m:mi>S</m:mi>
                <m:mi>x</m:mi>
                <m:mi>i</m:mi>
              </m:msubsup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mover>
              <m:mo>→</m:mo>
              <m:mrow>
                <m:mi>a</m:mi>
                <m:mo>.</m:mo>
                <m:mi>s</m:mi>
                <m:mo>.</m:mo>
                <m:mo>,</m:mo>
                <m:mi>n</m:mi>
                <m:mo>→</m:mo>
                <m:mi>∞</m:mi>
              </m:mrow>
            </m:mover>
            <m:mi>E</m:mi>
            <m:msub>
              <m:mi>f</m:mi>
              <m:mi>k</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>x</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id66898">In block codes we want</para>
      <equation id="id66904">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mi>N</m:mi>
              </m:mrow>
            </m:mfrac>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>0</m:mn>
              </m:mrow>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:munderover>
            <m:mi>l</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mi>N</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>i</m:mi>
                  <m:mo>+</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>)</m:mo>
                  <m:mi>N</m:mi>
                </m:mrow>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mover>
              <m:mo>=</m:mo>
              <m:mtext>a.s.</m:mtext>
            </m:mover>
            <m:mi>H</m:mi>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id67008">We will be content with convergence in probability, and a.s. convergence is better.</para>
      <para id="id67014"><emphasis effect="bold">Theorem 4</emphasis> 
Let <m:math overflow="scroll"><m:mi>X</m:mi></m:math> be a stationary ergodic source with <m:math overflow="scroll"><m:mrow><m:msub><m:mi>H</m:mi><m:mn>1</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>&lt;</m:mo><m:mi>∞</m:mi></m:mrow></m:math>,
then for every <m:math overflow="scroll"><m:mrow><m:mi>ϵ</m:mi><m:mo>&gt;</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mi>δ</m:mi><m:mo>&gt;</m:mo><m:mn>0</m:mn></m:mrow></m:math>, there exists <m:math overflow="scroll"><m:mrow><m:msub><m:mi>n</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>δ</m:mi><m:mo>,</m:mo><m:mi>ϵ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> such that
<m:math overflow="scroll"><m:mrow><m:mo>∀</m:mo><m:mi>n</m:mi><m:mo>≥</m:mo><m:msub><m:mi>n</m:mi><m:mn>0</m:mn></m:msub><m:mrow><m:mo>(</m:mo><m:mi>δ</m:mi><m:mo>,</m:mo><m:mi>ϵ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>,</para><equation id="id67148">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mo form="prefix">Pr</m:mo>
            <m:mo>{</m:mo>
            <m:mo>|</m:mo>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:mfrac>
            <m:mi>I</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>-</m:mo>
            <m:mover accent="true">
              <m:mi>H</m:mi>
              <m:mo>¯</m:mo>
            </m:mover>
            <m:mo>|</m:mo>
            <m:mo>}</m:mo>
            <m:mo>≤</m:mo>
            <m:mi>ϵ</m:mi>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id67229">where <m:math overflow="scroll"><m:mrow><m:mi>I</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mo>-</m:mo><m:mo form="prefix">log</m:mo><m:mrow><m:mo>(</m:mo><m:mo form="prefix">Pr</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.</para>
      <para id="id67325">The proof of this result is quite lengthy. We discussed it in detail, but skip it here.</para>
      <para id="id67329"><link target-id="id67014">Theorem 4</link> is called the ergodic theorem of information theory or the ergodic theorem of entropy.
Shannon (48') proved convergence in probability for stationary ergodic Markov sources.
McMillan (53') proved <m:math overflow="scroll"><m:msup><m:mi>L</m:mi><m:mn>1</m:mn></m:msup></m:math> convergence for stationary ergodic sources.
Brieman (57'/60') proved convergence with probability 1 for stationary ergodic sources.</para></section>
    <section id="uid15">
      <title>Parametric Models of Information Sources</title>
      <para id="id67365">In this section, we will discuss several parametric models and see what their entropy rate is.</para>
      <para id="id67369"><emphasis effect="bold">Memoryless sources</emphasis>: We have seen for memoryless sources,</para>
      <equation id="id67377">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>x</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∏</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:munderover>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id67432">where there are <m:math overflow="scroll"><m:mrow><m:mi>r</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> parameters in total,</para>
      <equation id="id67452">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>θ</m:mi>
            <m:mo>=</m:mo>
            <m:mo>{</m:mo>
            <m:mi>p</m:mi>
            <m:mo>(</m:mo>
            <m:mi>a</m:mi>
            <m:mo>)</m:mo>
            <m:mo>,</m:mo>
            <m:mi>a</m:mi>
            <m:mo>=</m:mo>
            <m:mn>1</m:mn>
            <m:mo>,</m:mo>
            <m:mn>2</m:mn>
            <m:mo>,</m:mo>
            <m:mo>.</m:mo>
            <m:mo>.</m:mo>
            <m:mo>.</m:mo>
            <m:mo>,</m:mo>
            <m:mi>r</m:mi>
            <m:mo>-</m:mo>
            <m:mn>1</m:mn>
            <m:mo>}</m:mo>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id67511">the parameters are denoted by <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>,
and <m:math overflow="scroll"><m:mrow><m:mi>α</m:mi><m:mo>=</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:mi>r</m:mi><m:mo>}</m:mo></m:mrow></m:math> is the alphabet.</para>
      <para id="id67562"><emphasis effect="bold">Markov sources</emphasis>:
The distribution of a Markov source is defined as</para>
      <equation id="id67571">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mn>2</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>,</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>.</m:mo>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mi>k</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:munderover>
              <m:mo>∏</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mi>k</m:mi>
                <m:mo>+</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:munderover>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>x</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mo>|</m:mo>
              <m:msubsup>
                <m:mi>x</m:mi>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mo>-</m:mo>
                  <m:mi>k</m:mi>
                </m:mrow>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msubsup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id67720">where <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>≥</m:mo><m:mi>k</m:mi></m:mrow></m:math>. We must define <m:math overflow="scroll"><m:msub><m:mrow><m:mo>{</m:mo><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>a</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:msub><m:mi>a</m:mi><m:mi>k</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow><m:mrow><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>a</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:msub><m:mi>a</m:mi><m:mi>k</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>∈</m:mo><m:msup><m:mi>α</m:mi><m:mi>k</m:mi></m:msup></m:mrow></m:msub></m:math> initial probabilities and transition probabilities, <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>a</m:mi><m:mrow><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>|</m:mo><m:msubsup><m:mi>a</m:mi><m:mn>1</m:mn><m:mi>k</m:mi></m:msubsup><m:mo>)</m:mo></m:mrow><m:mo>}</m:mo></m:mrow></m:math>. There are <m:math overflow="scroll"><m:mrow><m:msup><m:mi>r</m:mi><m:mi>k</m:mi></m:msup><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> initial probabilities and <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>(</m:mo><m:mi>r</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:msup><m:mi>r</m:mi><m:mi>k</m:mi></m:msup></m:mrow></m:math> transition probabilities, giving a total of <m:math overflow="scroll"><m:mrow><m:msup><m:mi>r</m:mi><m:mrow><m:mi>k</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> parameters. Note that</para>
      <equation id="id67966">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>E</m:mi>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:mo>-</m:mo>
              <m:mo form="prefix">log</m:mo>
              <m:mi>p</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>|</m:mo>
                <m:msubsup>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>-</m:mo>
                    <m:mi>k</m:mi>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msubsup>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>H</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mo>|</m:mo>
              <m:msubsup>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mo>-</m:mo>
                  <m:mi>k</m:mi>
                </m:mrow>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msubsup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mover>
              <m:mo>→</m:mo>
              <m:mrow>
                <m:mi>k</m:mi>
                <m:mo>→</m:mo>
                <m:mi>∞</m:mi>
              </m:mrow>
            </m:mover>
            <m:mover accent="true">
              <m:mi>H</m:mi>
              <m:mo>¯</m:mo>
            </m:mover>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>X</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id68099">Therefore, the space of Markov sources covers the stationary ergodic sources in the limit of large <m:math overflow="scroll"><m:mi>k</m:mi></m:math>.</para>
      <para id="id68115"><emphasis effect="bold">Unifilar sources</emphasis>:
For unifilar sources, it is possible to reconstruct the set of states that a source went through by looking at the output sequence. In the Markov case we have <m:math overflow="scroll"><m:mrow><m:msub><m:mi>S</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mrow><m:mo>(</m:mo><m:msubsup><m:mi>X</m:mi><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mi>k</m:mi></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msubsup><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, but in general it may be more complicated to determine the state.</para>
      <para id="id68169">To put us on a concrete basis for analysis of unifilar sources, consider a source with <m:math overflow="scroll"><m:mi>M</m:mi></m:math> states, <m:math overflow="scroll"><m:mrow><m:mi>S</m:mi><m:mo>=</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:mi>M</m:mi><m:mo>}</m:mo></m:mrow></m:math>, and an alphabet <m:math overflow="scroll"><m:mrow><m:mi>α</m:mi><m:mo>=</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>.</m:mo><m:mo>,</m:mo><m:mi>r</m:mi><m:mo>}</m:mo></m:mrow></m:math>. In each time step, the source outputs a symbol and moves to a new state. Denote the output sequence by <m:math overflow="scroll"><m:mrow><m:mi>x</m:mi><m:mo>=</m:mo><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:msub><m:mi>x</m:mi><m:mn>2</m:mn></m:msub><m:mo>⋯</m:mo><m:msub><m:mi>x</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math>, and the state sequence by <m:math overflow="scroll"><m:mrow><m:mi>s</m:mi><m:mo>=</m:mo><m:msub><m:mi>s</m:mi><m:mn>1</m:mn></m:msub><m:msub><m:mi>s</m:mi><m:mn>2</m:mn></m:msub><m:mo>⋯</m:mo><m:msub><m:mi>s</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math>, where <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mo>∈</m:mo><m:mi>S</m:mi></m:mrow></m:math> and <m:math overflow="scroll"><m:mrow><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>∈</m:mo><m:mi>α</m:mi></m:mrow></m:math>. Denote also</para>
      <equation id="id68368">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>q</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>|</m:mo>
                  <m:msup>
                    <m:mi>s</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mtext>Pr</m:mtext>
                  <m:mo>{</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mi>s</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                  <m:mo>}</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mtext>Pr</m:mtext>
                  <m:mo>{</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mi>s</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>2</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:mo>⋯</m:mo>
                  <m:mo>}</m:mo>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id68530">This is a first-order time-homogeneous Markov source.
The probability that the next symbol is <m:math overflow="scroll"><m:mi>a</m:mi></m:math> follows,</para>
      <equation id="id68546">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>p</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>a</m:mi>
                  <m:mo>|</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mtext>Pr</m:mtext>
                  <m:mo>{</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>a</m:mi>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>}</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mtext>Pr</m:mtext>
                  <m:mo>{</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>a</m:mi>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:mo>⋯</m:mo>
                  <m:mo>}</m:mo>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id68694">There exists a deterministic function,</para>
      <equation id="id68700">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>S</m:mi>
              <m:mi>t</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mi>g</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id68757">this is called the next state function.
Given that we start at some state <m:math overflow="scroll"><m:mrow><m:msub><m:mi>S</m:mi><m:mn>1</m:mn></m:msub><m:mo>=</m:mo><m:msub><m:mi>s</m:mi><m:mn>1</m:mn></m:msub></m:mrow></m:math>, the probability for the sequence of
states <m:math overflow="scroll"><m:mrow><m:msub><m:mi>s</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>s</m:mi><m:mi>n</m:mi></m:msub></m:mrow></m:math> is given by</para>
      <equation id="id68817">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msubsup>
                <m:mi>X</m:mi>
                <m:mn>1</m:mn>
                <m:mi>n</m:mi>
              </m:msubsup>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∏</m:mo>
              <m:mrow>
                <m:mi>t</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:munderover>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>t</m:mi>
              </m:msub>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mi>t</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id68900">Note the relation</para>
      <equation id="id68906">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>q</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>s</m:mi>
              <m:mo>|</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>a</m:mi>
                <m:mo>:</m:mo>
                <m:mi>g</m:mi>
                <m:mo>(</m:mo>
                <m:msup>
                  <m:mi>s</m:mi>
                  <m:mo>'</m:mo>
                </m:msup>
                <m:mo>,</m:mo>
                <m:mi>a</m:mi>
                <m:mo>)</m:mo>
                <m:mo>=</m:mo>
                <m:mi>s</m:mi>
              </m:mrow>
            </m:munder>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>a</m:mi>
              <m:mo>|</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id68992">To summarize, unifilar sources can be described by a state machine style of
diagram as illustrated in <link target-id="uid16"/>.</para>
      <figure id="uid16"><media id="uid16_media" alt="State machine for selecting the state of a unifilar source.">
          <image mime-type="image/png" src="../../media/02022012_a.png" id="uid16_onlineimage" width="500"><!-- NOTE: attribute width changes image size online (pixels). original width is 686. --></image>
          <image mime-type="application/postscript" for="pdf" src="../../media/02022012_a.eps" id="uid16_printimage"/>
        </media>
        
      <caption>State machine for selecting the state of a unifilar source.</caption></figure><para id="id69017">Given that an initial state was fixed, a unifilar source with <m:math overflow="scroll"><m:mi>M</m:mi></m:math> states and an alphabet of size <m:math overflow="scroll"><m:mi>r</m:mi></m:math> can be expressed with <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>(</m:mo><m:mi>r</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math> parameters. If the initial state is a random variable, then there are <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> parameters that define probabilities for the initial state, giving <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>(</m:mo><m:mi>r</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo><m:mo>+</m:mo><m:mi>M</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>=</m:mo><m:mi>M</m:mi><m:mi>r</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> parameters in total. In the Markov case, we have <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>=</m:mo><m:msup><m:mi>r</m:mi><m:mi>k</m:mi></m:msup></m:mrow></m:math>, it is a special type of unifilar source.</para>
      <example id="fs-id1166660522021"><para id="id69134">For the unifilar source that appears in <link target-id="uid18"/>, the states can be discerned from the output sequence. Let us follow up on this example while discussing more properties of unifilar sources.</para></example>
      <figure id="uid18"><media id="uid18_media" alt="Unifilar source for Example 3">
          <image mime-type="image/png" src="../../media/02022012_b.png" id="uid18_onlineimage" width="500"><!-- NOTE: attribute width changes image size online (pixels). original width is 638. --></image>
          <image mime-type="application/postscript" for="pdf" src="../../media/02022012_b.eps" id="uid18_printimage"/>
        </media>
        
      <caption>Unifilar source for <link target-id="fs-id1166660522021"/>.</caption></figure><para id="id69169">A state <m:math overflow="scroll"><m:mi>S</m:mi></m:math> is called <emphasis effect="italics">transient</emphasis> if once we leave it we cannot go back;
<m:math overflow="scroll"><m:msub><m:mi>S</m:mi><m:mn>1</m:mn></m:msub></m:math> is such a state in the exaple. A subset <m:math overflow="scroll"><m:mi>E</m:mi></m:math> of states is called <emphasis effect="italics">irreducible</emphasis>
if from every state in <m:math overflow="scroll"><m:mi>E</m:mi></m:math> it is possible to move to every other state in <m:math overflow="scroll"><m:mi>E</m:mi></m:math> in a finite
number of steps, and it is impossible to leave <m:math overflow="scroll"><m:mi>E</m:mi></m:math>. We see that <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>S</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>S</m:mi><m:mn>3</m:mn></m:msub><m:mo>}</m:mo></m:mrow></m:math> and
<m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:msub><m:mi>S</m:mi><m:mn>4</m:mn></m:msub><m:mo>}</m:mo></m:mrow></m:math> are irreducible sets. The states can be decomposed (in a single unique way)
into a set of transient states and irreducible components. It can be shown that with
probability 1 the time spent in transient states is finite, and after that the source enters
one of the irreducible components and stays there forever.
Finally, in an ergodic source there may only be one irreducible component.
Therefre, our example source is not ergodic because it contains two such components.</para>
      <para id="id69298">Given that we are in some state <m:math overflow="scroll"><m:mi>s</m:mi></m:math>, which belongs to an irreducible component,
the number of time steps until we return to <m:math overflow="scroll"><m:mi>s</m:mi></m:math> for the first time is a random variable
called <emphasis effect="italics">recurrence time</emphasis>. The <emphasis effect="italics">period</emphasis> of an irreducible component is the largest
integer that divides all possible recurrence times.</para>
      <example id="fs-id1166677550639"><para id="id69331">In the unifilar source in <link target-id="uid20"/> the period is 1, because recurrence time could be 2 or 3.
However, it is impossible for the recurrence time to be 1.</para></example>
      <figure id="uid20"><media id="uid20_media" alt="Unifilar source for Example 4">
          <image mime-type="image/png" src="../../media/02022012_c.png" id="uid20_onlineimage" width="295"><!-- NOTE: attribute width changes image size online (pixels). original width is 295. --></image>
          <image mime-type="application/postscript" for="pdf" src="../../media/02022012_c.eps" id="uid20_printimage"/>
        </media>
        
      <caption>Unifilar source for <link target-id="fs-id1166677550639"/>.</caption></figure><para id="id69367">An irreducible component with period at least 2 is called periodic. In contrast,
a component with period 1 is called aperiodic or ergodic, because the probabilities in being in
each of the states eventually converge to the statistical averages.
Note that a periodic component cannot yield a stationary distribution.</para>
      <para id="id69375">An irreducible component <m:math overflow="scroll"><m:mi>E</m:mi></m:math> contains asymptotic state probabilities given by the solution of the equations,</para>
      <equation id="id69389">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:msup>
                  <m:mi>s</m:mi>
                  <m:mo>'</m:mo>
                </m:msup>
                <m:mo>∈</m:mo>
                <m:mi>E</m:mi>
              </m:mrow>
            </m:munder>
            <m:mi>q</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mi>q</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>s</m:mi>
              <m:mo>|</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>q</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>,</m:mo>
            <m:mspace width="1.em"/>
            <m:mo>∀</m:mo>
            <m:mi>s</m:mi>
            <m:mo>∈</m:mo>
            <m:mi>E</m:mi>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id69480">Additionally,</para>
      <equation id="id69486">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munder>
              <m:mo movablelimits="true" form="prefix">lim</m:mo>
              <m:mrow>
                <m:mi>t</m:mi>
                <m:mo>→</m:mo>
                <m:mi>∞</m:mi>
              </m:mrow>
            </m:munder>
            <m:mtext>Pr</m:mtext>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mi>t</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>s</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>q</m:mi>
              <m:mi>∞</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id69572">for aperiodic <m:math overflow="scroll"><m:mi>E</m:mi></m:math>. The convergence of <m:math overflow="scroll"><m:mrow><m:mtext>Pr</m:mtext><m:mo>{</m:mo><m:msub><m:mi>S</m:mi><m:mi>t</m:mi></m:msub><m:mo>=</m:mo><m:mi>s</m:mi><m:mo>|</m:mo><m:msub><m:mi>S</m:mi><m:mn>1</m:mn></m:msub><m:mo>=</m:mo><m:msup><m:mi>s</m:mi><m:mo>'</m:mo></m:msup><m:mo>}</m:mo></m:mrow></m:math> to <m:math overflow="scroll"><m:mrow><m:mi>q</m:mi><m:mo>(</m:mo><m:mi>s</m:mi><m:mo>)</m:mo></m:mrow></m:math> is exponential in <m:math overflow="scroll"><m:mi>t</m:mi></m:math>,
and depends on the eigen-values of the transition probability matrix. In periodic components we do
not have stationarity, but the following weaker property still holds,</para>
      <equation id="id69660">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munder>
              <m:mo movablelimits="true" form="prefix">lim</m:mo>
              <m:mrow>
                <m:mi>t</m:mi>
                <m:mo>→</m:mo>
                <m:mi>∞</m:mi>
              </m:mrow>
            </m:munder>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mi>t</m:mi>
            </m:mfrac>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>t</m:mi>
            </m:munderover>
            <m:mtext>Pr</m:mtext>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>s</m:mi>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>q</m:mi>
              <m:mi>∞</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id69748">The entropy rate of the output of a unifilar source at state <m:math overflow="scroll"><m:mi>s</m:mi></m:math> is given by,</para>
      <equation id="id69764">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>H</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>X</m:mi>
              <m:mo>|</m:mo>
              <m:mi>S</m:mi>
              <m:mo>=</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mo>-</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>a</m:mi>
                <m:mo>∈</m:mo>
                <m:mi>A</m:mi>
              </m:mrow>
            </m:munder>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>a</m:mi>
              <m:mo>|</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>·</m:mo>
            <m:mo form="prefix">log</m:mo>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>a</m:mi>
              <m:mo>|</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id69846">To see this, we begin with a lemma.</para>
      <para id="id69851"><emphasis effect="bold">Lemma 1</emphasis> For a unifilar source,</para>
      <equation id="id69864">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>H</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>|</m:mo>
              <m:msubsup>
                <m:mi>X</m:mi>
                <m:mrow>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msubsup>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>s</m:mi>
                <m:mo>∈</m:mo>
                <m:mi>S</m:mi>
              </m:mrow>
            </m:munder>
            <m:mo form="prefix">Pr</m:mo>
            <m:mrow>
              <m:mo>{</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>s</m:mi>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>}</m:mo>
            </m:mrow>
            <m:mi>H</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>X</m:mi>
              <m:mo>|</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id70008"><emphasis effect="italics">Proof</emphasis> <m:math overflow="scroll"><m:mrow><m:mo form="prefix">Pr</m:mo><m:mrow><m:mo>{</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msubsup><m:mi>X</m:mi><m:mn>1</m:mn><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msubsup><m:mo>,</m:mo><m:msub><m:mi>S</m:mi><m:mn>1</m:mn></m:msub><m:mo>}</m:mo></m:mrow><m:mo>=</m:mo><m:mtext>Pr</m:mtext><m:mrow><m:mo>{</m:mo><m:msub><m:mi>X</m:mi><m:mi>n</m:mi></m:msub><m:mo>|</m:mo><m:msub><m:mi>S</m:mi><m:mi>n</m:mi></m:msub><m:mo>,</m:mo><m:msubsup><m:mi>X</m:mi><m:mn>1</m:mn><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msubsup><m:mo>,</m:mo><m:msub><m:mi>S</m:mi><m:mn>1</m:mn></m:msub><m:mo>}</m:mo></m:mrow></m:mrow></m:math>, because <m:math overflow="scroll"><m:msub><m:mi>S</m:mi><m:mi>n</m:mi></m:msub></m:math> is deterministic in <m:math overflow="scroll"><m:msub><m:mi>S</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math>, <m:math overflow="scroll"><m:msub><m:mi>X</m:mi><m:mrow><m:mi>n</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:math>. Therefore, owing to the Markov property,</para><equation id="id70172">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mtext>Pr</m:mtext>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>|</m:mo>
              <m:msubsup>
                <m:mi>X</m:mi>
                <m:mn>1</m:mn>
                <m:mrow>
                  <m:mi>n</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msubsup>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mtext>Pr</m:mtext>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id70253">We can now compute the entropy,</para>
      <equation id="id70259">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>H</m:mi>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mi>n</m:mi>
                  </m:msub>
                  <m:mo>|</m:mo>
                  <m:msubsup>
                    <m:mi>X</m:mi>
                    <m:mn>1</m:mn>
                    <m:mrow>
                      <m:mi>n</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msubsup>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:msub>
                    <m:mi>s</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>-</m:mo>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msubsup>
                        <m:mi>X</m:mi>
                        <m:mn>1</m:mn>
                        <m:mi>n</m:mi>
                      </m:msubsup>
                      <m:mo>,</m:mo>
                      <m:msub>
                        <m:mi>S</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:munder>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msubsup>
                      <m:mi>X</m:mi>
                      <m:mn>1</m:mn>
                      <m:mi>n</m:mi>
                    </m:msubsup>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo form="prefix">log</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mo form="prefix">Pr</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>|</m:mo>
                      <m:msubsup>
                        <m:mi>X</m:mi>
                        <m:mn>1</m:mn>
                        <m:mrow>
                          <m:mi>n</m:mi>
                          <m:mo>-</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msubsup>
                      <m:mo>,</m:mo>
                      <m:msub>
                        <m:mi>S</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>-</m:mo>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msubsup>
                        <m:mi>X</m:mi>
                        <m:mn>1</m:mn>
                        <m:mi>n</m:mi>
                      </m:msubsup>
                      <m:mo>,</m:mo>
                      <m:msub>
                        <m:mi>S</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:munder>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msubsup>
                      <m:mi>X</m:mi>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mi>n</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msubsup>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:msub>
                      <m:mi>X</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                  </m:munder>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>X</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo form="prefix">log</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mo form="prefix">Pr</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>X</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>|</m:mo>
                      <m:msub>
                        <m:mi>S</m:mi>
                        <m:mi>n</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mi>S</m:mi>
                  </m:munder>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>=</m:mo>
                    <m:mi>s</m:mi>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>·</m:mo>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>X</m:mi>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>=</m:mo>
                    <m:mi>s</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id70703">Having proved the lemma, we can move forward with the
computation of entropy rate. Note that</para>
      <equation id="id70707">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mi>n</m:mi>
                  </m:mfrac>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>X</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>.</m:mo>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>X</m:mi>
                      <m:mi>n</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mi>n</m:mi>
                  </m:mfrac>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>l</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>n</m:mi>
                  </m:munderover>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>X</m:mi>
                      <m:mi>l</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msubsup>
                      <m:mi>X</m:mi>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mi>l</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msubsup>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mi>n</m:mi>
                  </m:mfrac>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>l</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>n</m:mi>
                  </m:munderover>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>s</m:mi>
                      <m:mo>∈</m:mo>
                      <m:mi>S</m:mi>
                    </m:mrow>
                  </m:munder>
                  <m:mtext>Pr</m:mtext>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>l</m:mi>
                    </m:msub>
                    <m:mo>=</m:mo>
                    <m:mi>s</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>·</m:mo>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>X</m:mi>
                    <m:mo>|</m:mo>
                    <m:mi>s</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>s</m:mi>
                      <m:mo>∈</m:mo>
                      <m:mi>S</m:mi>
                    </m:mrow>
                  </m:munder>
                  <m:mfenced separators="" open="[" close="]">
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mi>n</m:mi>
                    </m:mfrac>
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>l</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>n</m:mi>
                    </m:munderover>
                    <m:mtext>Pr</m:mtext>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>S</m:mi>
                        <m:mi>l</m:mi>
                      </m:msub>
                      <m:mo>=</m:mo>
                      <m:mi>s</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mfenced>
                  <m:mi>H</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>X</m:mi>
                    <m:mo>|</m:mo>
                    <m:mi>S</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi>s</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>,</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id71020">and</para>
      <equation id="id71025">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:mfrac>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>l</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:munderover>
            <m:mtext>Pr</m:mtext>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mi>l</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>→</m:mo>
            <m:msub>
              <m:mi>q</m:mi>
              <m:mi>∞</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id71097">Therefore,</para>
      <equation id="id71102">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:munder>
              <m:mo movablelimits="true" form="prefix">lim</m:mo>
              <m:mrow>
                <m:mi>n</m:mi>
                <m:mo>→</m:mo>
                <m:mi>∞</m:mi>
              </m:mrow>
            </m:munder>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mi>n</m:mi>
            </m:mfrac>
            <m:mi>H</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msubsup>
                <m:mi>X</m:mi>
                <m:mn>1</m:mn>
                <m:mi>n</m:mi>
              </m:msubsup>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>s</m:mi>
                <m:mo>∈</m:mo>
                <m:mi>S</m:mi>
              </m:mrow>
            </m:munder>
            <m:msub>
              <m:mi>q</m:mi>
              <m:mi>∞</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mi>H</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>X</m:mi>
              <m:mo>|</m:mo>
              <m:mi>s</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id71211">It is not complicated to show that this is the entropy rate of the unifilar source <m:math overflow="scroll"><m:mi>X</m:mi></m:math>, provided that it is irreducible and aperiodic.</para>
      <para id="id71225"><emphasis effect="bold">Tree Sources</emphasis>: Tree sources are very useful in modeling and processing text and data files in general.
Consequently, tree sources have been studied in great detail.
We will introduce these source models here and later in <link document="m46233"/>
discuss algorithms for universal lossless compression of these sources.</para><para id="id71239">In a tree source, states are arranged as <emphasis effect="italics">contexts</emphasis>,
where a context consists of the last several symbols generated
by the source. The unique property of a context tree source is that states are arranged as leaves
of a tree, and the state can be identified by following labels of the branches of the tree based on
previous symbols, until we reach a leaf.</para>
      <example id="fs-id1166673422827"><para id="id71251"> <link target-id="uid23"/> shows a simple tree source. For this source, a typical input might be</para> </example>
      <equation id="id71268">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>x</m:mi>
            <m:mo>=</m:mo>
            <m:mn>011001010</m:mn>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id71287">This input sequence corresponds to the following sequence of states,</para>
      <equation id="id71293">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>s</m:mi>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>01</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>11</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>01</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>01</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>s</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <figure id="uid23"><media id="uid23_media" alt="Tree source for Example 5">
          <image mime-type="image/png" src="../../media/02072012_a.png" id="uid23_onlineimage" width="364"><!-- NOTE: attribute width changes image size online (pixels). original width is 364. --></image>
          <image mime-type="application/postscript" for="pdf" src="../../media/02072012_a.eps" id="uid23_printimage"/>
        </media>
        
      <caption>Tree source for <link target-id="fs-id1166673422827"/>.</caption></figure><para id="id71393">As before, for every state (leaf) there exist conditional probabilities for generating the next symbol. That said, and maybe surprisingly, a tree source is not necessarily a unifilar source. On the one hand, states can be observed from the source symbols. On the other hand, when transitioning from a “shallow" leaf to a deep leaf in the tree, the symbol currently being generated does not contain enough information to define the new state. To address this problem, extra states can be added to the tree.
On the other hand, adding extra states to a tree source might make the context tree less efficient,
because it increases the number of states;
see for example the detailed discussion of expansion of tree machines by Martín et al. <link target-id="bid1"/>.</para>
      <para id="id71412"><emphasis effect="bold">Hidden Markov models</emphasis>: Consider the following state transition probabilities,</para>
      <equation id="id71420">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mtext>Pr</m:mtext>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>a</m:mi>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mi>s</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>2</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>.</m:mo>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mtext>Pr</m:mtext>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>X</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>a</m:mi>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mi>t</m:mi>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                  </m:msub>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mi>s</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mo>(</m:mo>
                  <m:mi>a</m:mi>
                  <m:mo>,</m:mo>
                  <m:mi>s</m:mi>
                  <m:mo>|</m:mo>
                  <m:msup>
                    <m:mi>s</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                  <m:mo>)</m:mo>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id71634">The parameter space can be defined,</para>
      <equation id="id71640">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>θ</m:mi>
            <m:mo>=</m:mo>
            <m:mo>{</m:mo>
            <m:mo form="prefix">Pr</m:mo>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>a</m:mi>
              <m:mo>,</m:mo>
              <m:mi>s</m:mi>
              <m:mo>|</m:mo>
              <m:msup>
                <m:mi>s</m:mi>
                <m:mo>'</m:mo>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>}</m:mo>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id71687">there are <m:math overflow="scroll"><m:mrow><m:mi>M</m:mi><m:mo>(</m:mo><m:mi>M</m:mi><m:mo>·</m:mo><m:mi>r</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math> parameters in total.</para>
      <para id="id71718">Note that</para>
      <equation id="id71722">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mo form="prefix">Pr</m:mo>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msubsup>
                <m:mi>X</m:mi>
                <m:mn>1</m:mn>
                <m:mi>n</m:mi>
              </m:msubsup>
              <m:mo>,</m:mo>
              <m:msubsup>
                <m:mi>S</m:mi>
                <m:mn>1</m:mn>
                <m:mi>n</m:mi>
              </m:msubsup>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mn>0</m:mn>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∏</m:mo>
              <m:mrow>
                <m:mi>t</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:munderover>
            <m:mo form="prefix">Pr</m:mo>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msub>
                <m:mi>X</m:mi>
                <m:mi>t</m:mi>
              </m:msub>
              <m:mo>,</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mi>t</m:mi>
              </m:msub>
              <m:mo>|</m:mo>
              <m:msub>
                <m:mi>S</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msub>
              <m:mo>)</m:mo>
            </m:mrow>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id71834">and</para>
      <equation id="id71840">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mo>(</m:mo>
                  <m:msubsup>
                    <m:mi>X</m:mi>
                    <m:mn>1</m:mn>
                    <m:mi>n</m:mi>
                  </m:msubsup>
                  <m:mo>|</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mn>0</m:mn>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:msubsup>
                      <m:mi>s</m:mi>
                      <m:mn>1</m:mn>
                      <m:mi>n</m:mi>
                    </m:msubsup>
                  </m:munder>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msubsup>
                      <m:mi>X</m:mi>
                      <m:mn>1</m:mn>
                      <m:mi>n</m:mi>
                    </m:msubsup>
                    <m:mo>,</m:mo>
                    <m:msubsup>
                      <m:mi>S</m:mi>
                      <m:mn>1</m:mn>
                      <m:mi>n</m:mi>
                    </m:msubsup>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mn>0</m:mn>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munder>
                    <m:mo>∑</m:mo>
                    <m:msubsup>
                      <m:mi>s</m:mi>
                      <m:mn>1</m:mn>
                      <m:mi>n</m:mi>
                    </m:msubsup>
                  </m:munder>
                  <m:munderover>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>n</m:mi>
                  </m:munderover>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>X</m:mi>
                      <m:mi>t</m:mi>
                    </m:msub>
                    <m:mo>,</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>t</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mrow>
                        <m:mi>t</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id72039">It is important to emphasize that the next state is not deterministic. This type of behavior is called a hidden Markov model (HMM).</para>
      <para id="id72045">What are the typical sets for HMM sources?
Recall that for an i.i.d. source we saw</para>
      <equation id="id72049">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mo form="prefix">Pr</m:mo>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msubsup>
                <m:mi>X</m:mi>
                <m:mn>1</m:mn>
                <m:mi>n</m:mi>
              </m:msubsup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munder>
              <m:mo>∏</m:mo>
              <m:mrow>
                <m:mi>a</m:mi>
                <m:mo>∈</m:mo>
                <m:mi>A</m:mi>
              </m:mrow>
            </m:munder>
            <m:mo form="prefix">Pr</m:mo>
            <m:msup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>a</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mrow>
                <m:msub>
                  <m:mi>n</m:mi>
                  <m:mi>x</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>a</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:msup>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id72128">this is the main concept underlying the method of types. For a unifilar source,</para>
      <equation id="id72134">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mo>(</m:mo>
                  <m:msubsup>
                    <m:mi>X</m:mi>
                    <m:mn>1</m:mn>
                    <m:mi>n</m:mi>
                  </m:msubsup>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munderover>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>t</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>n</m:mi>
                  </m:munderover>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>X</m:mi>
                      <m:mi>t</m:mi>
                    </m:msub>
                    <m:mo>|</m:mo>
                    <m:msub>
                      <m:mi>S</m:mi>
                      <m:mi>t</m:mi>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munder>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>A</m:mi>
                      <m:mo>×</m:mo>
                      <m:mi>S</m:mi>
                    </m:mrow>
                  </m:munder>
                  <m:mo form="prefix">Pr</m:mo>
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>a</m:mi>
                      <m:mo>|</m:mo>
                      <m:mi>s</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mrow>
                      <m:msub>
                        <m:mi>n</m:mi>
                        <m:mi>X</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>a</m:mi>
                        <m:mo>|</m:mo>
                        <m:mi>s</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mrow>
                  </m:msup>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id72287">For an HMM, there is no such partition into typical sets.</para>
    </section>
  </content>
  <bib:file>
    <bib:entry id="bid0">
      <bib:book>
        <!--required fields-->
        <bib:author>Gallager, R. G.</bib:author>
        <bib:title>Information Theory and Reliable Communications</bib:title>
        <bib:publisher>Wiley</bib:publisher>
        <bib:year>1968</bib:year>
        <!--optional fields-->
        <bib:volume/>
        <bib:series/>
        <bib:address/>
        <bib:edition/>
        <bib:month/>
        <bib:note/>
      </bib:book>
    </bib:entry>
    <bib:entry id="bid1">
      <bib:article>
        <!--required fields-->
        <bib:author>Martin, A. and Seroussi, G. and Weinberger, M. J.</bib:author>
        <bib:title>Linear time universal coding and time reversal of tree sources via FSM closure</bib:title>
        <bib:journal>IEEE Trans. Inf. Theory</bib:journal>
        <bib:year>2004</bib:year>
        <!--optional fields-->
        <bib:volume>50</bib:volume>
        <bib:number>7</bib:number>
        <bib:pages>1442-1468</bib:pages>
        <bib:month>Jul.</bib:month>
        <bib:note/>
      </bib:article>
    </bib:entry>
  </bib:file>
</document>